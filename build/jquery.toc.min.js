/* Table of Contents jQuery plugin v.0.1.0 https://github.com/alexdesignworks/jquery-toc | License: GPL-2.0 */
!function(e){'use strict';function t(t,r){this.pluginName=n,this.version=i,this.tree=[],this.anchors=[],this.options=e.extend({},{headings:['h2','h3','h4'],pager:!1,levelsCollapsible:[],levelsCollapsed:!1,link:!0,sectionClass:'toc-section-wrap',tocContainerClass:'toc-container'},r),this.$element=e(t),this.init()}var n='toc',i='0.1.0';e.extend(t.prototype,{init:function(){var t=this;e(t.options.headings.join(','),t.$element).each(function(){var n=e(this),i=t.getLevel(n);t.addItem(n,i)}),t.options.link&&(t.addAnchors(t.tree),t.options.levelsCollapsible.length>0&&(t.wrapAllCollapsed(t.tree),e(window).on('hashchange.toc',function(){var e=t.findActiveItem(window.location.hash.substr(1));(e=e||t.getDefaultActiveSection())&&t.toggleSectionsVisibility(e)}))),t.$toc=t.renderToc(t.tree),t.$element.before(t.$toc),t.$element.on('next.toc',function(e,n){var i=n.level||0,r=t.findNextItem(window.location.hash.substr(1),i);r&&t.toggleSectionsVisibility(r)}),t.$element.on('prev.toc',function(e,n){var i=n.level||0,r=t.findPrevItem(window.location.hash.substr(1),i);r&&t.toggleSectionsVisibility(r)}),t.options.levelsCollapsed&&e(window).trigger('hashchange.toc')},toggleSectionsVisibility:function(t){this.getAllSections().hide(),this.getAllSectionsFromItem(t).show();var n=e('.'+this.options.tocContainerClass).find('a[href="#'+t.anchor+'"]');this.$element.trigger('shown.toc',{element:t.element,tocElement:n}),window.location.hash=t.anchor},getAllSections:function(){return this.$element.find('.'+this.options.sectionClass)},getAllSectionsFromItem:function(e){return e.element.parent('.'+this.options.sectionClass)},findNextItem:function(e,t){for(var n=this.toList(this.tree).filter(function(e){return e.level===t}),i=0;i<n.length;i++)if(n[i].anchor===e&&i+1<n.length)return n[i+1];return null},findPrevItem:function(e,t){for(var n=this.toList(this.tree).filter(function(e){return e.level===t}),i=0;i<n.length;i++)if(n[i].anchor===e&&i-1>=0)return n[i-1];return null},findActiveItem:function(e){var t=this.toList(this.tree).filter(function(t){return t.anchor===e});return t.length>0?t.pop():null},getDefaultActiveSection:function(){return this.tree.length>0?this.tree[0]:null},wrapAllCollapsed:function(e){var t=this,n=this.toList(e);n=n.filter(function(e){return t.options.levelsCollapsible.indexOf(e.level)>-1});for(var i=0;i<n.length;i++){var r=i<n.length-1?n[i+1].element:null,o=n[i].element.nextUntil(r);o=o.add(n[i].element),t.renderSectionWrap(o,n[i].level)}},toList:function(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&(n.push(t[i]),t[i].children.length>0&&e.merge(n,this.toList(t[i].children)));return n},addItem:function(e,t){for(var n=0,i=this.tree;n<t;){var r=i.length-1,o=[{element:null,children:[]}];i[r].children=i[r].children||o,i=i[r].children,n++}i.push({element:e,level:t,children:[]})},getLevel:function(e){for(var t in this.options.headings)if(e.is(this.options.headings[t]))return parseInt(t);throw'Unable to get level for provided element'},addAnchors:function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t].anchor=this.generateAnchor(e[t].element.text()),this.renderAnchor(e[t]),e[t].children.length>0&&this.addAnchors(e[t].children))},generateAnchor:function(e){for(var t=e.toLowerCase().replace(/ /g,'-'),n=t,i=2;this.anchors.indexOf(n)>-1;)n=t+'-'+i,i++;return this.anchors.push(n),n},renderItem:function(e,t){var n=e.element.text();this.options.link&&(n='<a href="#'+e.anchor+'">'+n+'</a>');var i=[];return t.isFirst&&i.push('first'),t.isLast&&i.push('last'),'<li class="'+i.join(' ')+'">'+n+'</li>'},renderList:function(e){for(var t='<ul>',n=0;n<e.length;n++){var i={isFirst:0===n,isLast:n===e.length-1};t+=this.renderItem(e[n],i),e[n].children.length>0&&(t+=this.renderList(e[n].children))}return t+='</ul>'},renderAnchor:function(e){e.element.prepend('<a id="'+e.anchor+'"></a>')},renderSectionWrap:function(e,t){e.wrapAll('<div class="'+this.options.sectionClass+' level-'+t+'"></div>')},renderToc:function(e){var t='<div class="'+this.options.tocContainerClass+'">';return t+=this.renderList(e),t+='</div>'}}),e.fn[n]=function(i){return this.each(function(){e.data(this,'plugin_'+n)||e.data(this,'plugin_'+n,new t(this,i))})}}(jQuery);